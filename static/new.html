<!DOCTYPE html>
<head>
<meta charset="utf-8" />
<title>Audio Socket Example</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>    
<script>

var audioContext = new (window.AudioContext || window.webkitAudioContext)();
var AudioStart =0;

function playPcmChunk(audio){
    var source = audioContext.createBufferSource();
    var audioBuffer = audioContext.createBuffer(1, audio.length , 44100);
    audioBuffer.getChannelData(0).set(audio);
    source.buffer = audioBuffer;
    source.start(AudioStart);
    AudioStart += audioBuffer.duration;
}

function int16ToFloat32(inputArray, startIndex, length) {
    var output = new Float32Array(inputArray.length-startIndex);
    for (var i = startIndex; i < length; i++) {
        var int = inputArray[i];
        // If the high bit is on, then it is a negative number, and actually counts backwards.
        var float = (int >= 0x8000) ? -(0x10000 - int) / 0x8000 : int / 0x7FFF;
        output[i] = float;
    }
    return output;
}


function connect() {
    var ws = new WebSocket("ws://audiosocket.sammachin.com:8000/browser");
    ws.binaryType = 'arraybuffer';
    ws.onopen = function() {
        console.log('Connected');
        
    };
	ws.onmessage = function (messageEvent) {
		console.log(".");
        audioData = int16ToFloat32(new Uint16Array(event.data), 0, 882);
		playPcmChunk(audioData);
	      
	};
}




</script>
<center>
	<h2> Somethign new from Stack Overflow</h2>
    <p> call 07520 616161 then click connect</p>
<form>
<form>
<input type="button" style="height: 75px; width: 150px;" value="Connect" onClick="connect()">
</form>
</center>
<audio>
</body>
</html>